---
title: C++类
date: 2024-04-11 00:00:00 +0800
last_modified_at: 2024-04-15 00:00:00 +0800
categories: [cpp, syntax]
tags: [cpp]
author: author1
---

### 前文

较详细的从分解helloworld、数组、字符串，加上大概基本的语法知识点，为的是编写基本的代码，
但C++是面向对象的一门编程语言，所以第四个较详细更新的是c++的类。

### 正文

#### 类的概念

在计算机相关课程中，或多或少都接触过，类不过是一组数据、函数的集合（C没有类的概念，C有结构体），面向对象的语言都有类的概念，有了类的概念，接着封装、继承、多态，面向对象的三大特性能帮助更好的编写代码。

在vs中，如果输入`class`，默认会有一个类的模板：
```
class MyClass
{
    public:
        MyClass();
        ~MyClass();
    private:
};
MyClass::MyClass(){}
MyClass::~MyClass(){}
```

（格式稍有调整），上述便是vs这个IDE自带的类模板，稍微解释一下，`MyClass()`在类被实例化的时候被启动，`~MyClass()`在类实例化被销毁的时候启动，这在java等语言中都有，注意的是这个模板将这两个函数的定义放在了外面，也就是说类中的函数也可以先声明后定义。

不看模板，一个类简单来定义如下：
```
class Student { // 类的类型首字母大写是约定
    int code, age;
    string name;
    void exam();
}
```

这就组织了一个类，当然上述省略了很多，但是在大多数面向对象语言中，类就是组织了一些变量、函数。类创建的
对象被称为类的实例化。

上述代码很简单，但也值得思考，前面我们已经接触过类了，如字符串中string类，但注意到没，我们用string类获取字符串
长度的时候，用的是`size()`函数（或者称方法），这是string提供给我们的，再或者，引入的`cout`输出和`cin`输入，我们并不是直接和`cin`中的变量进行交互，而是`getline()`，这意味着**在设计类的时候，应该暴露出一个方法去与用户（或者说其他代码）进行交互。**

那既然有暴露的公用方法（或者可以称为接口）给用户，也有私有的方法，因此首先要引出三个访问控制关键字。

#### 问题1：类中数据的访问控制

从上节中应该知道尽量暴露接口给用户而不是直接让用户操作数据，C++提供了private、protected和public三个关键字
来修饰类的中的变量或函数，如：
```
class Student {
    private:
        int code, age;
        string name;
        void setAge();
    public:
        void exam();
        void setBirthday();
}
```

上述中，注意变量应该放在叫private的修饰符下，这意味只有`Student`抖括号中才能访问它，哪怕是`main`函数也不行，
而public意味着使用类对象的程序都可以访问。此外private不用显式的声明，默认是private。

#### 类和结构体

C++中仍然保留了结构体这种数据类型，与类不同的是结构体的默认访问限制是public（**注意，C结构体没有private这种访问修饰，也没有成员函数等**），如：
```
struct Student
{
    int code;
    string name;
};
```

（和class不同的是，结构体用struct定义），当然，这里声明结构体变量时需要`struct Student zhangsan;`，这只是语法不同。与类不同的是，结构体应该是一堆数据的集合，所以，不要像类那样放很多功能。

#### 类的构造函数和析构函数

如第一节，与类同名的函数为构造函数，结合C++函数章节，构造函数也可以重载：
```
class Student
{
	public:
		int code = 0;
		string name = "";
		int score;
		Student() { score = 0; }
		Student(int a) { score = a; }
		~Student() {};
};

int main()
{
	Student zhangsan;
	cout << zhangsan.score << endl;
	Student lisi(90);
	cout << lisi.score << endl;
	return 0;
}
```

构造函数通常用来做初始化设置，如需要的内存大小等。

相反的，`~Student()`被称为析构函数，在实例化对象被销毁时启动。这有个问题，什么时候被销毁，一般来说，
不同地方的变量生命周期不一样，如函数内的，在右大抖括号结束时整个作用域就结束了。析构函数也可以被调用。
